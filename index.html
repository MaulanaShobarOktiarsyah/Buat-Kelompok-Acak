<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>File Google Drive</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 0;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            background-color: #f4f4f4;
        }

        .iframe-container {
            width: 90%;
            max-width: 1000px;
            height: 80vh;
            box-shadow: 0 4px 10px rgba(0,0,0,0.2);
            border-radius: 10px;
            overflow: hidden;
            background-color: #fff;
        }

        iframe {
            width: 100%;
            height: 100%;
            border: none;
        }
    </style>
</head>
<body>
    <div class="iframe-container">
        <iframe src="https://drive.google.com/file/d/10JBE6k3bQ4SvIIrIZoljz6ygvQesiAHv/preview" allow="autoplay"></iframe>
    </div>
</body>
</html>
<script>
  const putri = ["üëß Siswi 1","üëß Siswi 2","üëß Siswi 3"];
  const putra = [];
  for(let i=1;i<=32;i++){ putra.push("üßë Murid " + i); }

  const colors = ["#FFB6C1","#87CEFA","#90EE90","#FFD700","#FFA07A","#DA70D6","#40E0D0"];
  let currentGroups = [];

  function shuffle(array) {
    return array.sort(()=>Math.random()-0.5);
  }

  function generateGroups(){
    const numGroups = parseInt(document.getElementById('groupCount').value);
    const keepGirlsTogether = document.getElementById('keepGirlsTogether').checked;
    if(numGroups < 1){ alert('Masukkan jumlah kelompok valid!'); return; }

    const totalParticipants = [...putra,...putri];
    const baseSize = Math.floor(totalParticipants.length/numGroups);
    const extra = totalParticipants.length % numGroups;

    let shuffledPutra = shuffle([...putra]);
    let shuffledPutri = shuffle([...putri]);
    let groups = Array.from({length:numGroups},()=>[]);

    // LOGIKA SISWI
    if(keepGirlsTogether){
      if(baseSize >= 3){ // Siswi tetap bersama
        const girlGroupIndex = Math.floor(Math.random()*numGroups);
        groups[girlGroupIndex] = [...shuffledPutri];
        let ptr=0;
        for(let i=0;i<numGroups;i++){
          let target = baseSize + (i<extra?1:0);
          if(i===girlGroupIndex) target = Math.max(groups[i].length,target);
          while(groups[i].length < target && ptr < shuffledPutra.length){
            groups[i].push(shuffledPutra[ptr]); ptr++;
          }
        }
      } else { 
        // BaseSize <3 ‚Üí hanya 1 siswi dicampur secara random
        const randomIndex = Math.floor(Math.random()*shuffledPutri.length);
        const oneGirl = shuffledPutri.splice(randomIndex,1)[0]; // ambil 1 siswi random
        const allParticipants = shuffle([...shuffledPutra, oneGirl]);
        let ptr=0;
        for(let i=0;i<numGroups;i++){
          let target = baseSize + (i<extra?1:0);
          while(groups[i].length<target && ptr<allParticipants.length){
            groups[i].push(allParticipants[ptr]);
            ptr++;
          }
        }
        // Siswi tersisa dimasukkan secara acak ke kelompok lain
        shuffledPutri.forEach(girl=>{
          const index = Math.floor(Math.random()*numGroups);
          groups[index].push(girl);
        });
      }
    } else { // Siswi dicampur semua
      const allParticipants = shuffle([...putra,...putri]);
      let ptr=0;
      for(let i=0;i<numGroups;i++){
        let target = baseSize + (i<extra?1:0);
        while(groups[i].length<target && ptr<allParticipants.length){
          groups[i].push(allParticipants[ptr]);
          ptr++;
        }
      }
    }

    currentGroups = groups;
    renderTable(groups);
  }

  function renderTable(groups){
    const container = document.getElementById('groupsContainer');
    container.innerHTML = '<h3>üåü Hasil Kelompok:</h3>';
    const table = document.createElement('table');

    const headerRow = document.createElement('tr');
    groups.forEach((g,i)=>{
      const th = document.createElement('th');
      th.textContent = `Kelompok ${i+1} üéØ`;
      th.style.backgroundColor = colors[i % colors.length];
      headerRow.appendChild(th);
    });
    table.appendChild(headerRow);

    const maxRows = Math.max(...groups.map(g=>g.length));
    for(let r=0;r<maxRows;r++){
      const row = document.createElement('tr');
      groups.forEach((g,i)=>{
        const td = document.createElement('td');
        td.textContent = g[r]?g[r]:"";
        td.style.backgroundColor = colors[i % colors.length]+"55";
        row.appendChild(td);
      });
      table.appendChild(row);
    }

    container.appendChild(table);
  }

  function copyGroups(){
    if(currentGroups.length === 0){ alert("Belum ada kelompok untuk disalin!"); return; }
    let text = "";
    currentGroups.forEach((g,i)=>{
      text += `Kelompok ${i+1}:\n`;
      g.forEach(murid=>{
        text += `- ${murid}\n`;
      });
      text += "\n";
    });
    navigator.clipboard.writeText(text).then(()=>{
      alert("‚úÖ Kelompok berhasil disalin ke clipboard!");
    }).catch(err=>{
      alert("‚ùå Gagal menyalin kelompok: " + err);
    });
  }
</script>
</body>
</html>

